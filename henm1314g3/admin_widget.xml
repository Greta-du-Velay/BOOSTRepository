<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs
    title="Admin Widget"
    description="Manage your Repository."
    author="Team Boost"
    author_email="neulinger@dbis.rwth-aachen.de"
    height="400">
    <Require feature="opensocial-0.8" />
    <Require feature="openapp" />
    <OAuth>
    <Service name="openapp"                     
        xmlns:openapp="http://www.role-project.eu/xml/openapp/opensocialext/" 
        openapp:service="http://purl.org/role/terms/spaceService"
        openapp:permitReadAppend="http://purl.org/role/terms/data">
      
        <Request method="" url=""/>
      <Authorization url=""/>
      <Access method="" url=""/>
    </Service>
    </OAuth>
  </ModulePrefs>

  <Content type="html">
    <![CDATA[

    <!-- We use jQuery to manipulate DOM and Bootstrap for the interface. -->
      <script src="http://127.0.0.1:8073/role/henm1314g3/js/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="http://127.0.0.1:8073/role/henm1314g3/js/bootstrap.min.js"></script>
   
    <script src="http://dbis.rwth-aachen.de/gadgets/iwc/lib/iwc.js"></script>
    <script src="http://127.0.0.1:8073/role/henm1314g3/ladda/spin.min.js"></script>
    <script src="http://127.0.0.1:8073/role/henm1314g3/ladda/ladda.min.js"></script>
            
    <!-- Managers for BCN and Employee related stuff -->
    <script src="http://127.0.0.1:8073/role/henm1314g3/js/BCNManager.js"></script>
    <script src="http://127.0.0.1:8073/role/henm1314g3/js/EmployeeManager.js"></script>


    <!-- Define CSS -->
   <link rel="stylesheet" href="http://127.0.0.1:8073/role/henm1314g3/css/bootstrap.min.css">
 

    <!-- JavaScript Block -->
    <script>

    var space;
    var iwcClient;
    var bcnsList = new Array();

    gadgets.util.registerOnLoadHandler(init);
    var bcnGlobal; // for the current bcn

    function init(){
          
        space = new openapp.oo.Resource(openapp.param.space());
        iwcClient = new iwc.Client();
      //  iwcClient.connect(iwcCallback);
      }
      

    $(document).ready(function(){

      addKeywordsModal();
      $("#repoIDmenu").click(function() {
        $("#manageRepoModal").modal();

      });

      $("#keywordsIDmenu").click(function() {
        $("#addKeywordsModal").modal();
     }); 

      retrieveAllBcns(space, function(bcns){
            bcnsList = bcns;
            
            for(var i = 0; i < bcnsList.length; i++){
             var bcn = bcnsList[i];
             };
             addKeywordsModal();
          });

    });

    function addKeywordsModal() {

      $("#bodyKeywordsModal").empty();

         /* Sort according priority index and name */

        bcnsList.sort(function(a, b){
          if (a.priority==b.priority) {if(a.name.toLowerCase() < b.name.toLowerCase()) return -1; else return 1;}
          if(a.priority > b.priority)  return -1; else return 1;
          
        });

        var template =  "<tr>" +
                  "<td><h5>Choose goal: </h5></td>" +
                  "<td style='width:100px;' align='center'>" +
                  "<div class='btn-group'>" +
                    "</div>" +
                    "</td>" +
                "</tr>" +
                "<tr>" +
                "<td><h5 style='margin-top: 30px'>Choose learning indicator: </h5></td>" +
                "<td style='width:100px;' align='center'>" +
                     "<div class='btn-group'>" +
                    "</div>" +
                    "</td>" +
                "</tr>" +
                "<tr>" +
                "<td><h5>Enter keywords for: </h5></td>" +
                "</tr>"+
                "<tr>" +
                "<td><h5>#SomeGoal </h5></td>" +
                "<td><h5>#SomeLI </h5></td>" +
                "</tr>"+
                "<tr>" +
                 "<td colspan='2'><input class='form-control' id='disabledInput' type='text' placeholder='ex: responsive, design, widget...' disabled></td>"+
                "</tr>";

        var entry = $(template);
        var dropClass = $('<div class="btn-group"></div>'); 


        var dropDownName = "goalDropDown";
        var goalButton = $('<button type="button" class="btn btn-default dropdown-toggle li-btn" id="'+dropDownName+'" data-toggle="dropdown"><span class="glyphicon glyphicon-chevron-down"></span></button>');
        
        dropClass.append(goalButton);
       
        var dropDownMenu = $('<ul class="dropdown-menu pull-right" role="menu" aria-labelledby="'+dropDownName+'"></ul>');
        var element;
        
        for(var i=0; i<bcnsList.length; i++) {
          var bcn = bcnsList[i];
          console.log(bcn.name);
          element = $('<li role="presentation"> <a role ="menuitem" " href="#" tabindex="-1">'+bcn.name+'</a></li>');
          
          dropDownMenu.append(element);
       }
      dropClass.append(dropDownMenu);
    entry.find(".btn-group").append(dropClass);
          

    $("#bodyKeywordsModal").append(entry);
    }

               
    </script>

    <!-- HTML Block -->

    <div style="overflow-y: scroll; height:400px;">
      <div class="panel panel-primary">
   
        <div class="panel-heading">
            <h3 class="panel-title">Control Boost Widgets</h3>
        </div>

        <div class="list-group list-group-flush">
          <a href="#" id="repoIDmenu" class="list-group-item">
            <div><span class="glyphicon glyphicon-check pull-right" style="margin-right:5px;"></span>
               <h5 class="list-group-item-heading">Manage Learning Repositories</h5>
               <h6 class="list-group-item-text">Allow or restrict access to the learning repositories</h6>
            </div>
          </a>
          <a href="#" id="keywordsIDmenu" class="list-group-item">
            <div><span class="glyphicon glyphicon-list-alt pull-right" style="margin-right:5px;"></span>
               <h5 class="list-group-item-heading"> Assign Keywords to the LIÂ´s </h5>      
              <h6 class="list-group-item-text">Provide keywords to the learning indicators to help your employees search for the relevant content </h6>       
            </div>
            
          </a>
         
         
        </div>
 
      </div>
    </div>

    <!-- Modal to manage repositories -->

      <div class="modal fade" id="manageRepoModal" >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h5 class="modal-title">Choose repositories that you would like to restrict:</h5>
            </div>
            <div class="modal-body">
               <li class="list-group-item">
            <div class="checkbox">
                <label>
                  <input type="checkbox"> YouTube
                </label>
           </div>
          </li>
          <li class="list-group-item">
            <div class="checkbox">
                <label>
                  <input type="checkbox"> SlideShare
                </label>
            </div>
           </li>
          <li class="list-group-item">
            <div class="checkbox">
                <label>
                  <input type="checkbox"> Scribd
                </label>
            </div></li>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Save changes</button>
              
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->


      <!-- Modal to manage keywords -->

      <div class="modal fade" id="addKeywordsModal"> 
          <div class="modal-dialog">
              <div class="modal-content">
                  <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                      <h4 class="modal-title">Assign keywords to learning indicators:</h4>
                  </div>
                  <div class="modal-body" id="bodyKeywordsModal">

                  </div>
                  <div class="modal-footer">
                    <div class="form-actions">
                       <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                      <button type="submit" class="btn btn-primary">Assign keywords</button>
                    </div>
                  </div><!-- /.modal-footer -->
              </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->

    ]]>
  </Content>
</Module>