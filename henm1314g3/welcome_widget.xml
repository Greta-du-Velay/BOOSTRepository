<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    
    <ModulePrefs title="Welcome Widget"
		description="Wlcome Widget."
		author="Team Boost"
		author_email="henm1314g3@dbis.rwth-aachen.de"
		height="400"
		width="600">
  	<Require feature="opensocial-0.8" />
    <Require feature="openapp" />
    <OAuth>
		<Service name="openapp"                     
		    xmlns:openapp="http://www.role-project.eu/xml/openapp/opensocialext/" 
		    openapp:service="http://purl.org/role/terms/spaceService"
		    openapp:permitReadAppend="http://purl.org/role/terms/data">
			
		    <Request method="" url=""/>
			<Authorization url=""/>
			<Access method="" url=""/>
		</Service>
    </OAuth>
    </ModulePrefs>
    
    <Content type="html">
    <![CDATA[
		
		<!-- We use jQuery to manipulate DOM and jQuery-UI for the interface. -->
    	<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/jquery-1.10.2.min.js" type="text/javascript"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/bootstrap.min.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/boostShared.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/BCNManager.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/LearningDocumentsManager.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/ExpertsManager.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/WidgetsManager.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/AccessRightsManager.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/tree.js" type="text/javascript"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/ladda/spin.min.js"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/ladda/ladda.min.js"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/Ractive.js"></script>
		<script src="http://dbis.rwth-aachen.de/gadgets/iwc/lib/iwc.js"></script>
		<script src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/js/async.js"></script>

		<!-- Define CSS -->
		
		<link href="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/css/bootstrap.min.css" rel="stylesheet">
		<link href="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/css/tree.css" rel="stylesheet">
		<link rel="stylesheet" href="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/ladda/ladda-themeless.min.css">
		<!-- JavaScript Block -->
		<style type="text/css">
		#table1 {
					 border:none;
					}
		</style>
		<script>
			
			var space;
			var iwcClient;
			var userAccessRights;
			var agreed;
			var accessRights;
			
			gadgets.util.registerOnLoadHandler(init);
			function init(){
			    
				space = new openapp.oo.Resource(openapp.param.space());
				iwcClient = new iwc.Client();
				iwcClient.connect(iwcCallback);
			}

	$(function(){
			
		// Get the access rights: 
		retrieveAccessRights(function(access){
		accessRights = access;
		userAccessRights = access.getUserAccessRights();
		agreed = userAccessRights.hasAgreedToLicense;
		//debug
		//agreed = false; 

			if (!agreed)
				$("#agreeLisenceModal").modal();
			
				

			
			
			// $(function(){

			//       // help button click 

			//       $('#question').click(function(){
			//         $('#descriptionModal').modal({
			//         keyboard: true
			//           });
			//         }); 
			// });

			// var ruleRactive = new Ractive({
			// 		            el: 'viewRulesTemplateContainer',
			// 		            template: '#viewRulesTemplate',
			// 		            append: true
					           
			// 		        });

			// ruleRactive.on("viewRules", function(event){
					        	
			// 		        	$("#viewRulesModal").modal();
			// 		        });

			

			// function agreementFunction()
			// {
			// document.getElementById("welcomeIframe").src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/resources/agreement.html";
			// document.getElementById("agreement").class="btn btn-primary btn-sm active";
			// document.getElementById("about").class="btn btn-primary btn-sm";
			// }
		});  // end of the retrieveAccessRights
	});

		function iwcCallback(intent){
				if(intent.action == "WELCOME_CREATE"){
					
				}
			}


		function agreeFunction()
			{
			userAccessRights.hasAgreedToLicense = true;
			accessRights.update(function (){
				$("#agreeLisenceModal").modal("hide");
			});
			}


			</script>
			
		<!-- HTML Block -->
	<div style="overflow-y: scroll; height:400px;">
		<div class ="panel panel-primary">
			<div class="panel-heading">
				<a href="http://www.boost-project.eu/" target="_blank" style="float:right; margin:-5 5 5 5px;"><img src="http://127.0.0.1:8073/role/BOOSTRepository/henm1314g3/resources/boost.gif" alt="overall" width="45" height="25" alt="BOOST website"></a>

				<h3 class="panel-title"><span style="margin-right:5px;"></span> Welcome to the BOOST Project </h3>
			</div>
		
			<div id ="panel" class="panel-body">
				<div class="modal-body">
				<p>
					Quick Guide 
				</p>
							
			</div>
	</div>

    <div class="modal fade" id="agreeLisenceModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
  					<div class="modal-header">
    					<h4 class="modal-title" id="myModalLabel">User agreement rules</h4>
  					</div>
  					<div class="modal-body">
    					<form role="form">
								<div class="form-group">
									
									License Text 

								</div>
						</form>
					</div>
					<div class="modal-footer">
				        <button onclick="agreeFunction()" type="button" data-style="zoom-out" class="btn btn-primary ladda-button"><span class="ladda-label">Agree</span></button>
  					</div>
				</div>
			</div>
	</div>
		
		
	]]>
  </Content>
</Module>
